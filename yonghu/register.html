<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>注册</title>
    <link rel="stylesheet" type="text/css" href="../../layui/css/layui.css">
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: url("../../img/背景图.jpg") no-repeat center center fixed;
            background-size: cover;
        }

        .register-container {
            width: 500px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(56, 142, 60, 0.2);
            overflow: hidden;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .register-header {
            padding: 20px;
            text-align: center;
            color:#2e7d32;
        }

        .register-header h2 {
            font-size: 28px;
            margin: 0;
            font-weight: 600;
        }

        .register-body {
            padding: 30px;
            max-height: 500px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2e7d32;
            font-size: 14px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #c8e6c9;
            border-radius: 8px;
            font-size: 14px;
            color: #333;
            transition: all 0.3s;
            background-color: rgba(245, 250, 247, 0.8);
        }

        .form-control:focus {
            outline: none;
            border-color: #81c784;
            box-shadow: 0 0 0 3px rgba(129, 199, 132, 0.2);
        }

        .register-footer {
            padding: 20px;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .btn-register {
            width: 60%;
            padding: 12px;
            background-color: #4caf50;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 44px;
        }

        .btn-register:hover {
            background-color: #388e3c;
            transform: translateY(-2px);
        }

        .login-link {
            color: #4caf50;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
            display: inline-block;
            margin-top: 10px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .login-link:hover {
            color: #2e7d32;
            text-decoration: underline;
        }

        /* 自定义滚动条 */
        .register-body::-webkit-scrollbar {
            width: 6px;
        }

        .register-body::-webkit-scrollbar-track {
            background: rgba(200, 230, 201, 0.3);
            border-radius: 3px;
        }

        .register-body::-webkit-scrollbar-thumb {
            background-color: #81c784;
            border-radius: 3px;
        }

        /* 下拉选择框样式 */
        .layui-form-select dl {
            border: 1px solid #c8e6c9;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .layui-form-select dl dd.layui-this {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
    </style>
</head>
<body>
<div id="app">
    <div class="register-container">
        <div class="register-header">
            <h2>校园失物招领系统注册</h2>
        </div>

        <div class="register-body">
            <form class="layui-form" lay-filter="myForm">
                <div class="form-group">
                    <label for="username">账户</label>
                    <input type="text" id="username" name="username" lay-verify="required"
                           placeholder="请输入账户" autocomplete="off" class="form-control">
                </div>

                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" id="password" name="password" lay-verify="password1|required"
                           placeholder="请输入密码" autocomplete="off" class="form-control">
                </div>

                <div class="form-group">
                    <label for="password2">确认密码</label>
                    <input type="password" id="password2" name="password2" lay-verify="password2|required"
                           placeholder="请再次输入密码" autocomplete="off" class="form-control">
                </div>

                <div class="form-group">
                    <label for="yonghuName">用户姓名</label>
                    <input type="text" id="yonghuName" name="yonghuName" lay-verify="required"
                           placeholder="请输入用户姓名" autocomplete="off" class="form-control">
                </div>

                <div class="form-group">
                    <label for="yonghuPhone">手机号</label>
                    <input type="text" id="yonghuPhone" name="yonghuPhone" lay-verify="phone|required"
                           placeholder="请输入手机号" autocomplete="off" class="form-control">
                </div>

                <div class="form-group">
                    <label for="yonghuIdNumber">身份证号</label>
                    <input type="text" id="yonghuIdNumber" name="yonghuIdNumber" lay-verify="identity|required"
                           placeholder="请输入身份证号" autocomplete="off" class="form-control">
                </div>

                <div class="form-group">
                    <label>性别</label>
                    <select name="sexTypes" id="sexTypes" class="form-control">
                        <option v-for="(item,index) in sexTypesList" :value="item.codeIndex"
                                :key="item.codeIndex">{{ item.indexName }}</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="yonghuEmail">邮箱</label>
                    <input type="text" id="yonghuEmail" name="yonghuEmail" lay-verify="email|required"
                           placeholder="请输入邮箱" autocomplete="off" class="form-control">
                </div>
            </form>
        </div>

        <div class="register-footer">
            <button class="btn-register layui-btn layui-btn-fluid" lay-submit lay-filter="register">注 册</button>
            <a href="javascript:window.location.href='../login/login.html'" class="login-link">已有账号？立即登录</a>
        </div>
    </div>
</div>

<script src="../../layui/layui.js"></script>
<script src="../../js/vue.js"></script>
<script src="../../xznstatic/js/element.min.js"></script>
<script src="../../js/config.js"></script>
<script src="../../modules/config.js"></script>
<script src="../../js/utils.js"></script>
<script src="../../js/validate.js"></script>

<script>
    var vue = new Vue({
        el: '#app',
        data: {
            sexTypesList: [],
            jinyongTypesList: [],
        },
        updated: function () {
            layui.form.render(null, 'myForm');
        },
        methods: {
            jump(url) {
                jump(url);
            },
        }
    });

    layui.use(['layer', 'element', 'carousel', 'form', 'http', 'jquery'], function () {
        var layer = layui.layer;
        var element = layui.element;
        var carousel = layui.carousel;
        var form = layui.form;
        var http = layui.http;
        var jquery = layui.jquery;

        var tablename = http.getParam('tablename');
        //字典表数据容器
        // 性别的查询和初始化
        sexTypesSelect();
        // 账户状态的查询和初始化
        jinyongTypesSelect();
        // 表单效验规则
        form.verify({
            // 正整数效验规则
            integer: [
                /^[1-9][0-9]*$/
                , '必须是正整数'
            ]
            // 小数效验规则
            , double: [
                /^[1-9][0-9]{0,5}(\.[0-9]{1,2})?$/
                , '最大整数位为6为,小数最大两位'
            ]
            , password1: function (value, item) { //value：表单的值、item：表单的DOM对象
                var password2 = jquery("#password2").val();
                if (password2 != null && password2 != "" && password2 != "null") {
                    if (value != password2) {
                        return '密码的两次密码不一致';
                    }
                }
            }
            , password2: function (value, item) { //value：表单的值、item：表单的DOM对象
                var password1 = jquery("#password1").val();
                if (password1 != null && password1 != "" && password1 != "null") {
                    if (value != password1) {
                        return '密码的两次密码不一致';
                    }
                }
            }
        });

        // 注册
        form.on('submit(register)', function (data) {
            data = data.field;
            http.requestJson(tablename + '/register', 'post', data, function (res) {
                if(res.code==0){
                    layer.msg('注册成功', {
                        time: 2000,
                        icon: 6
                    }, function () {
                        // 路径访问设置
                        window.location.href = '../login/login.html';
                    });
                }else{
                    layer.msg(res.msg, {
                        time: 4000,
                        icon: 5
                    });
                }
            });
            return false
        });

        // 性别的查询
        function sexTypesSelect() {
            //填充下拉框选项
            http.request("dictionary/page?page=1&limit=100&sort=&order=&dicCode=sex_types", "GET", {}, (res) => {
                if (res.code == 0) {
                    vue.sexTypesList = res.data.list;
                }
            });
        }

        // 账户状态的查询
        function jinyongTypesSelect() {
            //填充下拉框选项
            http.request("dictionary/page?page=1&limit=100&sort=&order=&dicCode=jinyong_types", "GET", {}, (res) => {
                if (res.code == 0) {
                    vue.jinyongTypesList = res.data.list;
                }
            });
        }
    });
</script>
</body>
</html>